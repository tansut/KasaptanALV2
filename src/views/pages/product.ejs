<!DOCTYPE html>
<html lang="tr-TR" prefix="og: http://ogp.me/ns#">

<head>
  <% include ./_partial/head %>
  <% if (controller.productLd) { %>
  <script type="application/ld+json">
    <%- JSON.stringify(controller.productLd) %>
  </script>

  <% } %>
  <script>
    var gtags = [];
  </script>
  
  <% if (Object.keys(__req.query).length != 0 ) {%>
  <meta name="robots" content="noindex,follow">
  <link href="https://www.kasaptanal.com<%=__req.path%>" rel="canonical">
  <%}%>
</head>

<body>

  <%if (__req.query.frame != '1') { %> 
  <% include ./_partial/header %>
  <%}%>

  <%- include('./_partial/product-weight-calc.ejs', {    product: product}) %>

  <% otherButcherAlternatives = butchers.serving.length  + butchers.takeOnly.length - 1 %>


  <%if (__req.query.frame != '1') { %>
  <div  class=" page-title py-2">
    <div class="container d-lg-flex justify-content-between py-2 py-lg-3">
      <div class="order-lg-2 mb-3 mb-lg-0 pt-lg-2">
        
        <nav aria-label="breadcrumb" class="d-none d-lg-block">
          <ol class="breadcrumb breadcrumb-dark flex-lg-nowrap justify-content-center justify-content-lg-star">
            <li class="breadcrumb-item"><a class="text-nowrap" href="/"><i class="czi-home"></i></a></li>
            <li class="breadcrumb-item text-nowrap"><a href="/kasap-urunleri">Ürünler</a>
            </li>
          </ol>
        </nav>
        
      </div>
      <div class="order-lg-1 pr-lg-4 text-center text-lg-left">
        <h1 class="h3"><%= view.name %></h1>
        <h2 class="lead h4"><%= view.shortDesc %></h2>
        <% if (__req.user && __req.user.hasRole('admin')) {%>
        <a target="_blank" class="btn btn-dark btn-sm" href="/pages/admin/product/<%=product.slug%>">Düzenle
          <%=product.id%></a>
        <%}%>
      </div>
    </div>
  </div> 

  <% } %>

  <%
  let resources = product.resources.filter(r=>r.list == true); 
  let images = resources.filter(p=>p.contentType == "image/jpeg");
  let videos = resources.filter(p=>p.contentType == "video-youtube");
  let tarifs = resources.filter(p=>p.tag1 && p.tag1.includes("tarif"));
  let tarifsAndFoods = resources.filter(p=>p.tag1 && (p.tag1.includes("tarif") || p.tag1.includes("yemek")));
  nonDisplayedResources  = resources.filter(resource=> (resource.tag1 && resource.tag1.includes('yemek') && resource.ref1 != product.id))
  let videoTarifs = tarifs.filter(p=>p.contentType == "video-youtube");
  let hazirlanisResources = resources.filter(p=>p.tag1 == "hazirlama-sekli");
  let bilgiResources = resources.filter(p=>p.tag1 == "bilgi");
  let otherVideos = videos.filter(p=>(p.tag1 && !p.tag1.includes( "tarif") && p.tag1 != "hazirlama-sekli" ));
  let firstImage = images.length ? images[0]: null;  
  let chunks = _.chunk(images.slice(1, images.length), 3)
  let alternativeimages = images.slice(1, images.length)
  var butcherVideo = controller.butcherResources.find(br=>br.type == 'butcher-videos')
%>








        <div class="container px-0 cz-gallery">



          <div class="mb-3 pb-2 ">


            <div class="row no-gutters">

              <div class="col-lg-6 ">
                <% if (firstImage) { %>
                <div class="mb-3">
                  <%- include('./_partial/product-resource-view.ejs', {first: true, note: false, resource: firstImage}) %>
                </div>
                <% } %>

                <div class="table-responsive " data-simplebar>
                  <div class="d-flex">

                    <% for(var c=0; c< alternativeimages.length; c++) {%>
                    <div class="mr-2">

                      <div class="item-slider item-slider-sm">

                        <div class="card product-card  ">
                          <%- include('./_partial/product-resource-view.ejs', {first: false, note: false, resource: alternativeimages[c]}) %>
                        </div>

                      </div>
                    </div>
                    <%}%>


                  </div>
                </div>


              </div>

              <div id="productapp" v-cloak class="col-lg-6 px-3 ">
                <% if (view.butcher) {%>
                    <%- include('./_partial/butcher-alternatives.ejs', { alternates:  view.alternateButchers }) %>
                    <%}%>
                <% if (view.butcher) { %>
                    <div class="toast-container toast-top-center">
                      <div id="shopcard-added-toast" class="toast mb-3" id="accent-toast" data-delay="50000"
                        role="alert" aria-live="assertive" aria-atomic="true">
                        <div class="toast-header bg-secondary"><i class="czi-cart  mr-2"></i>
                          <h6 class="font-size-sm  mb-0 mr-auto">Sepetiniz güncellendi</h6>
                          <button class="close ml-2 mb-1" type="button" data-dismiss="toast"
                            aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        </div>
                        <div class="toast-body">

                          <div v-if="newlyAddedItem" class="mb-2">

                            

                            <div class="text-center">
                              <div class="text-center mb-3">
                                <img class="w-50" width="500" height="500" src="<%= `${__req.helper.imgUrl('product-photos', product.slug)}` %>"
                                  alt="<%=product.name%>">
                              </div>
                              <div>
                                <h3 class="product-title font-size-base mb-2"><a
                                    href="/<%=product.slug%>?butcher=<%=view.butcher.slug%>"><%=product.name%></a>
                                </h3>
                                <div class="font-size-normal"><span
                                    class="font-weight-medium">{{newlyAddedItem.quantity}}</span> <span
                                    class="text-muted">{{newlyAddedItem.purchaseoption.unitTitle }}

                                  </span>

                                  <span>/</span>
                                  <span class="font-size-sm">
                                    {{ formatCurrency(newlyAddedItem.price).val}}.<small>{{formatCurrency(newlyAddedItem.price).krs}}</small>
                                    TL


                                     
                                  </span>

                                  <!-- <span v-if="newlyAddedItem.purchaseoption.unitWeight"
                                    class="d-block text-muted font-size-xs">1
                                    {{newlyAddedItem.purchaseoption.unit}}
                                    {{newlyAddedItem.purchaseoption.unitWeight}}</span> -->

                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="">
                            <div class="d-flex d-flex justify-content-center">
                              <a onclick="return goBack()" class="btn btn-sm btn-primary mr-2">Alışverişe Devam</a>

                              <a onclick="return goShopcard()"  class="btn btn-sm btn-dark "><i
                                  class="czi-cart mr-1"></i>Sepete Git</a>
                              
                            </div>
                          </div>
                          <div>

                          </div>

                        </div>
                      </div>
                    </div>
                    <%} %>


                    <form id="product-form" @submit.prevent="addToShopcard">

                      <% if (controller.reviews.length) { %>
                        <div class="mb-3 text-center">
                          <div class="mb-1">
                            <%- include('./_partial/star-rating.ejs', {val: product.ratingValue }) %>
                          </div>
                          <a href="javascript:gotoComments()"
                            class="font-size-sm text-dark font-weight-medium"><span>Yorumlar
                              (</span><span class="text-primary"><%=controller.reviews.length %></span><span>)</span></a>
  
                        </div>
                        <% } %>

                      <% if (!view.butcher) { %>
                        <% if (!__req.prefAddr) { %>
                       
  
                        <div class="bg-secondary border font-size-sm mb-2 p-3">
  
  
  
  
                          <div class="mb-3 d-block font-size-sm  text-center">
                            <% if (controller.startPrice && controller.startPrice.title) { %>
                              <h5 class="h5">
                                <%=controller.startPrice.title%>
                              </h5>
                            <% } %>
                          
  
                            <p class="lead">
                              <% if (controller.startPrice) { %>
                                <% if (controller.startPrice.basedOn == 'global') { %>
                                  
  
                                  <%- include('./_partial/currency.ejs', {value: controller.startPrice.view.price, unit: controller.startPrice.view.unitTitle}) %><br>başlangıç fiyatlarıyla.
                                
                     
                          
  
                                <% } else { %>
                                  <%- include('./_partial/currency.ejs', {value: controller.startPrice.view.price, unit: controller.startPrice.view.unitTitle}) %>'
                             
  
                                  <%}%>
                                <% } else { %>
                                  Önce Semt Seçin
                                <%}%>
  
                                </p>
                            <% if (controller.startPrice) { %>
                              <div class="font-size-md mb-3">
                                <% if (controller.startPrice.basedOn == 'global') { %>
  
                                  <div>
                                    <span>Size hizmet veren kasaplarımızdan alışverişe başlamak için semt seçin.
                                  </div>
    
                            
                                <% } else { %>
                                  <div>
                                    <span>İstediğiniz gün ve saatte kapınıza getiriyoruz.</span> 
                                    Alışverişe başlamak için şimdi semtinizi seçin.
                                  </div>
    
                                <% } %>
                              </div>
                            
  
  
                            <% } else { %>
                              <div>
                                <span class="font-weight-medium">Alışverişe başlamak için</span> 
                                şimdi semtinizi seçin.
                              </div>
                              <%}%>
                        
  
                           
  
  
                          </div>
  
                          <div class="text-center">
                            <button @click="selectArea(null)" type="button" class="btn btn-primary"><i
                                class="czi-location font-size-lg mr-2"></i>Semtinizi Seçin</button>
                          </div>
  
  
                        </div>
                        <%} else { %>
                        <div class="bg-secondary border p-3  mb-2">
  
  
  
  
                          <div class="mb-3  text-center">
                            <% if (__req.query.butcher) {  %>
                          
                              <% if (!controller.dispatchingAvailable) { %>
                                <h5 class="h6 ">Henüz Semtinizde Değiliz</h5>
                                <p>
      
                                  Kasap seçim kriterlerimiz oldukça detaylı ve belirli bir planda ilerliyoruz.
                                  Çünkü sizlere en iyiyi sunmak için çalışıyoruz.
      
                                </p>
  
                                <script>
                                  gtags.push(['noservice', '<%=__req.prefAddr.display%>', '<%=product.slug%>']);
                                  gtags.push(['noproduct', '<%=product.slug%>', '<%=__req.prefAddr.display%>']);
                                </script>
      
                                <%} else { %>
                                <h5 class="h5">Semtinize hizmet
                                  veren kasaplarımız mevcut</h5>
                                <p>Ancak bu kasabımız semtinize hizmet veremiyor veya bu ürünü sağlayamıyor.</p>
                                <script>
                                  gtags.push(['noproduct', '<%=product.slug%>', '<%=__req.prefAddr.display%>']);
                                  gtags.push(['noservice', '<%=__req.prefAddr.display%>', '<%=product.slug%>']);
                                </script>
                                <% } %>
  
  
                            <% } else { %>
                              <% if (!controller.dispatchingAvailable) { %>
                                <h5 class="h6">Henüz Semtinizde Değiliz</h5>
                                <p>
      
                                  Kasap seçim kriterlerimiz oldukça detaylı ve belirli bir planda ilerliyoruz.
                                  Çünkü sizlere en iyiyi sunmak için çalışıyoruz.
      
                                </p>
  
                                
                                <script>
                                  gtags.push(['noproduct', '<%=product.slug%>', '<%=__req.prefAddr.display%>']);
                                  gtags.push(['noservice', '<%=__req.prefAddr.display%>', '<%=product.slug%>']);
                                </script>
                               
      
                                <%} else { %>
                                <h5 class="h5">Hizmet Veriyoruz</h5>
                                <p class="text-left">Ancak hiçbir kasabımız
                                  bu ürünü şu anda sağlayamıyor.</p>
                                  <p class="border bg-white p-3 text-left">
                                    <i class="czi-icon czi-truck mr-1"></i>
                                    <a class="font-weight-bold" href="javascript:gotoUrl('/tum-turkiye')">Tüm Türkiye'ye</a> gönderebildiğimiz ürünlerimiz var, mutlaka göz atın.
                                  </p>
                                  <script>       
                                  gtags.push(['noproduct', '<%=product.slug%>', '<%=__req.prefAddr.display%>']);
                                  gtags.push(['noservice', '<%=__req.prefAddr.display%>', '<%=product.slug%>']);

                                  </script>
                                <% } %>
                            <% } %>
                           
  
  
                          </div>
                          <% if (!controller.dispatchingAvailable) { %>
                          <div class="d-flex justify-content-center">
  
                            <% if (__req.query.frame != '1') { %>
                            <button @click="selectArea(null)" type="button" class="btn mr-2 btn-primary"><i
                                class="czi-location  mr-2"></i>Semt Seç</button>
                            <% } else { %>
                              <button onclick="window.parent.purchase.selectAddress('<%=product.slug%>')" type="button" class="btn mr-2 "><i
                                class="czi-location  mr-2"></i>Semt Seç</button>
                            <% } %>
                            <a class="btn btn-primary " onclick="return showButchers()">Kasaplarımız<i
                                class="czi-arrow-right mr-2"></i></a>
                          </div>
                          <%} else {%>
         
  
                          <div class="d-flex justify-content-center">
                            <a class="btn  btn-primary mr-2 btn-sm" onclick="return goBack()" >Alışverişe Devam</a>
  
                            <% if (__req.query.frame != '1') { %>
                              <button @click="selectArea(null)" type="button" class="btn btn-sm mr-2 btn-primary "><i
                                  class="czi-location mr-2 "></i>Semt Seç</button>
                              <% } else { %>
                                <button onclick="window.parent.purchase.selectAddress('<%=product.slug%>')" type="button" class="btn btn-sm mr-2 btn-primary "><i
                                  class="czi-location mr-2 "></i>Semt Seç</button>
                              <% } %>
  
                          </div>
  
                         
                          <%}%>
                    
                                  </div>
                                <%}%>
  
                          <% } %>

               




                      <% if (product.featuresText) { %>
                        
                      <% var notes = product.featuresText.split('\n') %>
                      <div class=" border-bottom mb-3  ">
                        <ul class="list-unstyled mb-2">
                          <%notes.forEach((note, i) => { %>
                          <li><i class="czi-check-circle text-primary mr-1"></i> <%=note%></li>
                          <%})%>
                        </ul>

                      </div>

                      <% } %>



                      <% if (bilgiResources.length) { %>

                      <div class="mb-3">

                        <div class="d-flex flex-nowrap justify-content-between align-items-center">



                          <h5 class="h6 mb-2 font-size-sm text-dark "></i>Yardımcı videolar</h5>




                        </div>
                        <div class="mb-2">
                          <% bilgiResources.forEach(t=> { %>

                          <div
                            class="d-flex mb-2 pb-1 align-items-center flex-nowrap justify-content-between border-bottom">
                            <a class="text-primary" href="javascript:openSlider(<%=t.id%>)"><i
                                class="text-primary <%= t.contentType == 'video-youtube' ? 'czi-youtube': 'czi-camera' %> mr-1"></i><%=t.title%></a>





                          </div>





                          <%})%>
                        </div>
                      </div>



                      <% } %>



                      <% if (tarifsAndFoods.length) { %>

                      <div class="mb-3">

                        <div class="d-flex flex-nowrap justify-content-between align-items-center">
                          <a href="#tarifVideos">


                            <h5 class="h6 font-size-sm mb-2 text-dark ">Bu yemekler için ideal</h5>



                          </a>
                   
                        </div>

                        <div class="mb-2">
                          <% tarifsAndFoods.forEach(t=> { %>

                          <div class="d-flex mb-2 pb-1 align-items-center flex-nowrap justify-content-between border-bottom">
                            <a class="text-primary" href="javascript:openSlider(<%=t.id%>)"><i
                                class="text-primary <%= t.contentType == 'video-youtube' ? 'czi-youtube': 'czi-camera' %> mr-1"></i><%=t.title%></a>


                            <a class="text-primary" title="Eti Bizden" data-tag="true" data-category="food"
                              data-action="eti-bizden" data-label="<%= t.slug%>"
                              href="javascript:<%= include('./_partial/addtonote.ejs', {resource: t, options: {hideProduct: true} }) %>"><span
                                class="color-primary">
                                <i class=" czi-add-circle"></i></span> </a>



                          </div>





                          <%})%>
                        </div>
                      </div>



                      <% } %>

                      <% if (hazirlanisResources.length) { %>

                        <div class="mb-3">
                          <h5 class="h6 mb-2">Şu şekilde hazırlayabiliriz</h5>
                          <div class="mb-2">
                            <% hazirlanisResources.forEach(t=> { %>

                            <div class="d-flex mb-2 pb-1  flex-wrap justify-content-between border-bottom">
                              <a href="javascript:openSlider(<%=t.id%>)"><i
                                  class=" czi-youtube mr-1"></i><%=t.title%></a>

                              <a title="Bu şekilde hazırlayın"
                                href="javascript:<%= include('./_partial/addtonote.ejs', {resource: t, options: {hideProduct: true} }) %>"><span
                                  class="color-primary"><i class=" czi-add-circle"></i></span>
                              </a>

                            </div>





                            <%})%>
                          </div>
                        </div>



                        <% } %>

                      <a id="aftersetloc"></a>








                        <a id="noteanchor"></a>

                       


                        <input type="hidden" id="product-id" value="<%= product.id %>" />

                      
                        <div class="">

                       
                          <%if (view.butcher) {  %>
                            <div class="mb-3">
                         
                            <%- include('./_partial/butcher-product-panel.ejs', { butcherVideo: butcherVideo }) %>

                         
                        </div>
                          <%}%>
                  
                      
                  
                  
                  
                  
                  
                                  
                   
                  
                             
                  
                               

                        <div class="mb-3">
                          <%- include(`./_partial/product.${product.productType}-editor.ejs`, {man: controller.ProductTypeManager}) %>

                        </div>

                      

                         
                         
                          <div class="d-flex font-size-sm mb-1 align-items-center justify-content-between ">
                            <span>
                             
                            </span>
                           
                               <a v-if="selectedUnit && selectedUnit.perPerson" @click="showCalculator(selectedUnit)"
                              class="text-dark font-weight-medium"><i class="czi-calculator mr-1"></i>Miktar Hesaplama</a> 
                                           
                          </div>
                          <div class="bg-white mb-2 pb-3 border shadow-lg">
                            <div v-if="product && product.purchaseOptions.length > 1">
                              <ul class="nav nav-pills nav-pills-dark nav-fill mb-2">
                                <li v-for="(option, index) in product.purchaseOptions" class="nav-item h-100">
                                  <a class="nav-link h-100 shadow-none " v-bind:class="{ active: option == selectedUnit }"
                                    @click="selectedUnit = option">{{option.unitTitle}}
                                   
                                    <span v-if="option.unitPrice > 0.00" class="d-block font-size-sm">
                                      {{  formatCurrency(option.unitPrice).val}}.<small>{{formatCurrency(option.unitPrice).krs}}</small>
                                      TL
                                    </span>
                                    
                                          </a>
                                            
                                        </li>
                      
                                      </ul>
                      
                                    
                      
                      
                                  </div>
                      
                                  
                                  
                                  <div v-if="selectedUnit" class="px-3">
                                  
                                      <div class="md-content mb-3 mt-3 border-bottom" v-html="selectedUnit.desc" v-if="selectedUnit.desc">
                                         
                                      </div>
                           
                                      <% if (view.butcher && __req.prefAddr) { %>
                                      <div class="d-flex  flex-nowrap justify-content-end align-items-center">
                                        <h5 class="h6 d-none mb-2 text-accent "><i class="czi-thumb-up mr-2"></i>Şimdi satın alın</h5>
                      
                                        <%if (__req.query.frame != '1') { %> 
                                        <button title="<%= __req.prefAddr ? __req.prefAddr.level3Text: 'Semtinizi Seçin' %>"
                                    @click="selectArea(null, '')" type="button" class="rounded-0 d-none btn
                                    btn-secondary btn-sm"><i class="czi-location font-size-lg "></i>
                                          <% } else {  %>
                                            <button title="<%= __req.prefAddr ? __req.prefAddr.level3Text: 'Semtinizi Seçin' %>"
                                              onclick="window.parent.purchase.selectAddress('<%=product.slug%>')" type="button" class="rounded-0 d-none btn
                                              btn-secondary btn-sm"><i class="czi-location font-size-lg "></i>
                                            
                                  <% }%>
    
    
                                    </button>
    
    
    
                            </div>
                                  </div>
                            <% } %>
                        
                      
                        
                      
                           
                            <div class="mt-2 d-flex align-items-center justify-content-center">
                              <p class="font-size-lg" v-if="selectedUnit.unit != 'kg'">Kaç <b>{{ selectedUnit.unitTitle }}</b> hazırlayalım?</p>
                              <p class="font-size-lg" v-if="selectedUnit.unit == 'kg'"><b>Ne kadar</b> hazırlayalım?</p>
                           
                              
                      
                            </div>

                          <amount-input class="mb-2 font-size-md" :def="quantity || selectedUnit.default" :min="selectedUnit.min"
                          :max="selectedUnit.max" :step="selectedUnit.step" v-model="quantity"
                          :unit="selectedUnit.unitTitle" >
                      
                        </amount-input>
                        <div class="text-center mb-3" v-if="selectedUnit && selectedUnit.unitWeight">
                          <span class="d-block text-muted font-size-sm">{{selectedUnit.unit != 'kg' ? '1 ' + selectedUnit.unit:''}} {{selectedUnit.unitWeight}}</span>
                    
                         </div>

                     


                        

                            <div v-if="selectedUnit" class="px-3 my-3 d-flex justify-content-between">
                              <div class="text-center">
                                <span class="text-muted font-size-sm d-block">
                                  
                                   Puan
                                </span>
                      
                                <money-view class="badge badge-success font-size-md font-weight-medium" :money="puan">
                                </money-view>
                              </div>
                      
                              <div class="text-center">
                                <span class="text-muted font-size-sm d-block">
                                  Tutar
                                </span>
                      
                                <money-view class="badge badge-dark font-weight-medium font-size-md" :money="price">
                                </money-view>
                              </div>
                      
                      
                            </div>

                        

                            <% if (view.butcher && __req.prefAddr) { %>


                              <div class="form-group px-3">
                                
    
                              </label>
                              <textarea v-model="note" maxlength="250"
                                :placeholder="(selectedUnit && selectedUnit.notePlaceholder) || (product && product.notePlaceholder) || 'İletmek istediğiniz notunuz varsa burayı kullanabilirsiniz.'"
                                class="form-control font-size-sm" rows="4" name="note" id="note">
    
                                                                      <%=view.note%>
                                                                  </textarea>
                            </div>
    
                          
                            <div class="px-3">
                              <button data-tag="true" data-category="shopcard/add" data-action="<%=view.butcher.slug%>"
                                data-label="<%=product.slug%>" id="addtoscbtn" class="btn btn-primary btn-block"
                                type="submit"><i
                                  class="czi-cart font-size-lg mr-2"></i><%= controller.shopCardIndex >= 0 ? 'Sepeti Güncelle': 'Sepete Ekle' %></button>
                            </div>
                         
    
                            <% } %>

                          </div>
                      
                        
                     

                           



                         

                    
                      
                        <% if ( view.alternateButchers.length && controller.showOtherButchers()) { %>
                          <div class="bg-secondary">
                            <% let alt2Show = 2 %>
                      
                            <div id="other-butchers-panel">
                              <p class="mb-3 font-size-md border-bottom">Diğer Kasaplar 
                      
                      
                                <% if (view.alternateButchers.length > alt2Show) { %>
                                 - 
                                    <a class="text-dark font-weight-bold" href="javascript:showOtherButchers()"><span>Tümünü Göster (</span><span class="text-primary"><%=otherButcherAlternatives %></span><span>)</span></a>
                      
                                 
                                <% } %>
                      
                                </p>
                            </div>
                           
                              <div class="">
                      
                                <div v-if="product">
                                  <div v-for="(alt, index) in product.alternateButchers.slice(0, <%=alt2Show%>)" class=" border-bottom mb-3">
                                    <a class="media align-items-start flex-grow-1" :data-butcher="alt.butcher.slug" href="#newbutcher" @click="selectNewButcher(alt.butcher)">
                                     
                                       <img class="w-25"
                                          :src="alt.butcher.thumbnail" :alt="alt.butcher.name">
                      
                                    
                      
                                      
                                      <div class="media-body px-3 pb-3">
                                        <h6 class="h6  mb-0">{{alt.butcher.name}}
                      
                                          
                                        </h5>
                                        <div v-if="alt.butcher.locationText" class="text-muted font-size-xs d-block">
                                          {{alt.butcher.locationText}}<span v-if="alt.dispatcher.priceInfo" >
                                             , {{alt.dispatcher.priceInfo}} 
                                         </span> 
                      
                                        </div>
                                        
                                        
                                          <money-view v-if="!alt.butcher.kgPrice && selectedUnitForAlternate(alt.butcher)" :unit="selectedUnitForAlternate(alt.butcher).unitTitle" 
                                          
                                          class="font-size-md text-dark" :money="selectedUnitForAlternate(alt.butcher).unitPrice"></money-view>
                                          <money-view v-else unit="Kg" 
                                          
                                          class="font-size-md text-dark" :money="alt.butcher.kgPrice"></money-view>
                            
                                       
                                         
                                            <div class="mb-2" v-if="alt.butcher.puanData">
                                              <span class="badge badge-success font-weight-medium">
                                                %{{alt.butcher.puanData.rate * 100 }}  Puan
                                              </span>
                                            </div>
                                          
                                       
                                            <div class="font-size-sm font-italic text-dark" v-if="alt.butcher.productNote" v-html="alt.butcher.productNote">                            
                       
                                            </div>   
                                         
                      
                                            <div class="d-flex w-100">
                                              <div class="w-50 pr-2" v-if="alt.butcher.userRatingAsPerc > 0">
                                                <div class="font-size-xs text-muted ">Memnuniyet</div>
                                                <div class="progress rounded-0">
                                                  <div class="progress-bar font-weight-medium bg-warning" role="progressbar" :style="'width:' + alt.butcher.userRatingAsPerc + '%'" :aria-valuenow="alt.butcher.userRatingAsPerc" aria-valuemin="0" aria-valuemax="100">
                                                    {{alt.butcher.userRatingAsPerc}}%
                                                  </div>  
                                                </div>
                                              </div>
                                              <div class="w-50 " v-if="alt.butcher.shipRatingAsPerc > 0">
                                                <div class="font-size-xs text-muted ">Teslimat Başarısı</div>
                                                <div class="progress rounded-0">
                                                  <div class="progress-bar font-weight-medium bg-warning" role="progressbar" :style="'width:' + alt.butcher.shipRatingAsPerc + '%'" :aria-valuenow="alt.butcher.shipRatingAsPerc" aria-valuemin="0" aria-valuemax="100">
                                                    {{alt.butcher.shipRatingAsPerc}}%
                                                  </div>  
                                                </div>
                                              </div>
                                             
                                        
                                             
                    
                                             
                                            </div>
                                
                      
                      
                                      </div>
                                    </a></div> 
                                </div>
                      
                      
                      
                           
                          </div>
                        </div>
                         <% } %>

                      


                        



                        </div>
                  
                                  </form>
                         
                  
                  
                       



                  </div> <!-- product app -->


                </div>

                <div id="tabpc"></div>


                <div>

                  <ul class="nav nav-tabs" id="optionsTab" role="tablist">

                    <li class="nav-item">
                      <a class="nav-link active %>" id="home-tab" data-toggle="tab" href="#home" role="tab"
                        aria-controls="home" aria-selected="true">Bilgi</a>
                    </li>
           
                    <%if (controller.reviews.length) { %>

                 
                       
                        <li id="usercomments" class="nav-item">
                          <a class="nav-link " id="comments-tab" data-toggle="tab" href="#comments" role="tab"
                            aria-controls="comments">Yorumlar</a>
                        </li>
                        <% } %>

                   


                        </ul>

                        <div class="tab-content px-4" id="myTabContent">
                          <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">

                            <%if (product.mddesc) { %>

                            <%- controller.markdown.render(product.mddesc || '') %>

                            <%}%>
            
                   
                     
                 
            
                  <% if (videoTarifs.length) {%>
                            <div id="tarifVideos"
                              class="d-flex flex-wrap justify-content-between align-items-center pt-1 border-bottom pb-1 mb-2">
                              <h3 class="h5 mb-0 mr-2">Et Yemek Tarifleri</h3>
                            </div>

                            <p>
                            <span class="btn btn-sm btn-primary mr-2"><i class=" czi-thumb-up mr-2">

                              </i>Eti Bizden</span>seçeneği ile etinizi istediğiniz yemeğe uygun olarak
                            hazırlıyoruz.</p>




                            <div class="row mb-3 ">
                              <% tarifsAndFoods.forEach((resource,i) => {%>
                              <% if (resource.contentType == "video-youtube") { %>
                              <div class="col-md-4 col-sm-6">
                                <%- include('./_partial/product-resource-view.ejs', {first: false, note: true, resource: resource}) %>




                              </div>
                              <% } %>
                              <%})%>



                            </div>
                            <%}%>
            
                    <% if (nonDisplayedResources.length) { %>
                            <% nonDisplayedResources.forEach((resource,i) => {%>
                            <div class="d-none">
                              <%- include('./_partial/product-resource-view.ejs', {first: false, note: false, resource: resource}) %>


                            </div>
                            <%})%>

                            <%}%>
            
                    <% if (otherVideos.length) {%>

                            <h3 class="border-bottom h5">Diğer kaynaklar</h3>








                            <div class="row mb-3">
                              <% otherVideos.forEach((resource,i) => {%>

                              <div class="col-md-4 col">


                                <%- include('./_partial/product-resource-view.ejs', {first: false, note: false, resource: resource}) %>


                              </div>
                              <%})%>
                            </div>
                            <%}%>
            
                            <h3 class="border-bottom h5">Online Sipariş</h3>

                            <p>
                              Yerel usta kasaplarımızdan <strong><%=product.name%> online siparişi
                              </strong> verebilir ve kasaplarımızın <strong>eve servis</strong> veya
                              <strong>paket servis</strong> olarak adlandırabileceğimiz hizmetlerinden
                              faydalanabilirsiniz:

                            </p>

                            <ul>
                              <li>
                                Semt seçimi yapın ve kasaptanAl.com anlaşmalı kasaplarımızı
                                görüntüleyin.
                              </li>
                              <li>
                                <strong>Online et siparişi</strong> vermek istediğiniz kasabımızı seçin
                                ve ürününüzü sepetine ekleyin.
                              </li>
                              <li>
                                Adresinizi girin ve siparişinizi tamamlayın.
                              </li>
                            </ul>
                            <p>
                              Tüm kasap iş ortaklarımız <strong>online ödeme</strong> kabul etmektedir.
                              Sepetinizdeki et ve et ürünlerini online ödeyerek zamandan kazanın.
                            </p>
                            <% if (tarifsAndFoods.length) { %>
                            <h3 class="border-bottom h5">Et Yemekleri</h3>
                            <p>
                              <strong>
                                <%=product.name%>
                              </strong>
                               ile aşağıdaki <strong>et yemekleri</strong> yapılabilir.
                            </p>
                            <ul>
                            <% tarifsAndFoods.forEach(tf=> { %>
                              <li><a title="<%=tf.title%>" href="/et-yemekleri/<%=tf.slug%>"><%=tf.title%></a></li>
                            <%})%>
                          </ul>

                            <% } %>


                     
                            <h3 class="border-bottom h5"><%=product.name%> Fiyatı</h3>





                            <p>



                              <strong><%=product.name%> fiyatları</strong> semtinize ve kasaplarımıza
                              göre farklılık göstermektedir. <strong>En uygun <%=product.name%>
                                fiyat</strong> bilgisi semt ve ürünü online olarak sağlayabilecek kasap
                              seçiminiz ardından otomatik olarak hesaplanmaktadır.
                            </p>

                            <% var categories = product.getCategories() %>

                            <% var priceCategories = [];
                           categories.forEach(c=>{
                             var pc = controller.req.__pricecategories.find(p=> (p.categoryid == c.id));
                             pc && priceCategories.push(pc)
                           })
                            
                           
                           %>
                            <% if (priceCategories.length) { %>
                            <p>
                              Aşağıdaki kategorilerdeki ürünlerimiz için <strong>et fiyatlarını</strong>
                              da incelemek isteyebilirsiniz.
                            <ul>


                              <% priceCategories.forEach(pc=> { %>
                              <li>
                                <a href="/<%=pc.slug %>"><%=pc.name %></a>
                              </li>

                              <% }) %>
                            </ul>
                            </p>
                            <%  } %>
                            <p>
                              Ayrıca <a href="/kasaplar">kasaplar</a>ımızın <a href="/et-fiyatlari">tüm
                                et fiyatlarını</a> da görüntülemek isteyebilirsiniz.
                            </p>

                          </div>

                          <%if (controller.reviews.length) { %>
                          <div class="tab-pane fade <%=controller.reviews.length?'': '' %> " id="comments" role="tabpanel" aria-labelledby="comments-tab">

                            <% controller.reviews.forEach(r => {  %>
                            <div class="product-review pb-4 mb-4 border-bottom">
                              <div class="d-flex mb-3">
                                <div class="media media-ie-fix align-items-center mr-4 pr-2">
                                  <div class="avatar">

                                    <img width="140" height="140" src="<%=__config.staticDomain %>/resource/img/avatar.jpg"
                                      alt="<%=r.displayUser%>">

                                  </div>

                                  <%
                      
                        const dateops = { year: 'numeric', month: 'long'};
            
                      %>

                                  <div class="media-body pl-3">
                                    <h6 class="font-size-sm mb-0"><%=r.displayUser%></h6>
                                   
                                      <a href="/<%=r.areaSlug%>-kasap" class="font-size-ms"><%=r.level3Text%></a>

                                   
                                  </div>
                                </div>
                                <div>
                                  <%- include('./_partial/star-rating.ejs', {val: r.userRating1 }) %>

                                  <div class="font-size-ms text-muted">
                                    <%=r.itemDate.toLocaleDateString('tr-TR', dateops)%> tarihli
                                    
              
                                    <a href="/<%=r.ref2slug%>"><%=r.ref2Text%></a>

                                  
                                    siparişi
                                  </div>
                                </div>
                              </div>
                              <p class="font-size-md mb-2">
                                <em>
                                  <%= r.content %>

                                </em>
                              </p>
                              <% if (r.settings && r.settings.products) { %>
                              <span class="d-block mb-1 font-weight-medium font-size-xs">
                                Sipariş verilen ürünler:
                              </span>


                              <% r.settings.products.forEach(p => { %>

                              <a class="mr-2 font-size-xs " href="/<%=p.slug%>"><i
                                  class="mr-1 czi-check-circle"></i><%=p.name%></a>




                              <% })%>


                              <% } %>
                              <% if (r.replyContent) { %>
                                <div class="font-size-sm text-dark mt-2 bg-secondary p-3 mt-3">
                                  <% if (r.replyDisplayUser) { %>
                                    <span class="d-block font-weight-bold"><%=r.replyDisplayUser%></span> 
                                  <% } %>
                                  
                                  <%- controller.markdown.render(r.replyContent) %>
                                </div>
                    
                              <% } %>
                            </div>
                            <% }) %>

                          </div>

                          <% } %>

                        </div>

                      </div> <!-- product desc & comments -->

                      <%if (__req.query.frame != '1') { %> 
                        <div class="container">
        
                          <%- include('./_partial/category-slider', { header:true, title: 'Ürünlerimiz', allUrl: '/kasap-urunleri' }); %>
                    
                        </div>
                        <%}%>
                  </div>
               


                </div>









                 <%if (__req.query.frame != '1') { %> 
                  <% include ./_partial/footer %>
                 <% } %> 
                <% include ./_partial/scripts %>

                <script>
                  window.App.ProductApp.shopCardIndex = <%= controller.shopCardIndex %>;
                  var prod = <%- JSON.stringify(view) %>;
                  window.App.ProductApp.product = prod;
                  window.App.WeightCalculatorApp.product = prod;
                  function setBody() {

                    // $("body").animate({ opacity: 1 }, 100, function () {

                    // });
                  }


                  <%if (__req.query.frame == '1') { %>
                  $(document).ready(function() {
                    $('#myTabContent a').attr('target','_blank');
                  })
                  <% } %>

                  function goShopcard() {
                    <%if (__req.query.frame != '1') { %>
                      window.location.href = '/alisveris-sepetim';
                    <%} else { %>
                      window.parent.purchase.goShopcard();
                    <% } %>
                  }

                  function gotoUrl(url) {
                    <%if (__req.query.frame != '1') { %>
                      location.href = url;
                    <%} else { %>
                      window.parent.purchase.go(url);
                    <% } %>
                  }

                  function showButchers() {
                    <%if (__req.query.frame != '1') { %>
                      location.href = '/kasaplar';
                    <%} else { %>
                      window.parent.purchase.go("/kasaplar");
                    <% } %>
                  }

                  function goBack() {
                    <%if (__req.query.frame != '1') { %>
                    
                    var toBack;
                    if (document.referrer.indexOf(location.protocol + "//" + location.host) === 0) {
                      var current = location.protocol + "//" + location.host + location.pathname;                      
                      if (document.referrer.indexOf(current) === 0) {
                        toBack = false;
                      }
                      else if (document.referrer.indexOf('/alisveris-sepetim') >= 0) {
                        toBack = false;
                      } else toBack = true;
                    } else toBack = false;
                    if (toBack) {
                      window.history.go(-1);
                      return false;
                    }
                    else window.location.href = "/kasap-urunleri"
                    <% } else { %>
                    window.parent.purchase.closePurchaseDialog()
                    <% } %>
                  }

                  function gotoComments() {
                    window.App.activaTab('comments');
                    window.App.scrollToAnchor('#usercomments')
                  }

                  function showOtherButchers() {
                    $('#butcher-alternatives').appendTo("body").modal('show');



                  }

                  function openSlider(i) {
                    var node = $('a[data-resid=' + i + ']')[0];
                    window.lgData.lg0.items.forEach(function (item, i) {
                      if (item == node || ((item.id && node.id) && (item.id == node.id))) {
                        window.location.hash = "lg=1&slide=" + i;
                        window.lgData.lg0.init()
                      }
                    })
                  }

                  $(document).ready(function() {
                    setBody();
                    for(var i=0;i<gtags.length;i++) {
                      var tag = gtags[i];
                      window.App.gTag(tag[0], tag[1], tag[2]);
                    }
                  })

                  <% if (!view.butcher && __req.prefAddr) {%>

               
                              


<% } else if (view.butcher && __req.prefAddr && __req.query.action == 'add2sc') { %>

                    $(document).ready(function () {
                      window.App.scrollToAnchor("#noteanchor")
                    })


                    <% } %> 

                  
                <% if (__req.query.r) { %>

                    $(document).ready(function () {

   
                  
                    <% if (!__req.query.autoNote) { %>
                        openSlider(<%=__req.query.r %>);

                    <% } else {
                        var r = product.resources.find(p => p.id == parseInt(__req.query.r))
                        var defaultImg = product.resources.find(p => p.contentType == 'image/jpeg');
                        if (defaultImg && r && (r != defaultImg)) {
                          r.thumbnailUrl = defaultImg.thumbnailUrl;
                          r.contentUrl = defaultImg.contentUrl;
                          r.contentType = defaultImg.contentType;
                          r.folder = defaultImg.folder;
                        } 
                    %>
                    <% if (!__req.query.disableSlider) { %>
   
                      

                     <% } %>

                          setTimeout(function () {
                            
                      <%- include('./_partial/addtonote.ejs', {
                              resource: r, options: {
                                hideProduct: __req.query.hideproduct
                              }
                            }) %>
                    }, 100);

                   
                  
                  <% } %>

                  })





                    <%} else { %>
                  
                      <%}%>



                </script>



                </body>

</html>
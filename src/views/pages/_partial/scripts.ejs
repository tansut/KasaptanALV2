<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script> -->

<% if (config.nodeenv == "production") { %>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146976156-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-146976156-1');
</script>


<% } %>

<script  src="/static/js/vendor.min.js?v=<%=__config.versionKey%>"></script>
<script  src="/static/js/site.min.js?v=<%=__config.versionKey%>"></script>
<script src="/static/js/app.js?v=<%=__config.versionKey%>"></script>



<script>



  window.shopcard = {
    card: {
      data: <%- JSON.stringify(__shopcard() || { items: [] }) %>,
    }
  };

  window.shopcard.count = new Vue({
    el: '#shopcardcount',
    data: {
      card: window.shopcard.card
    }
  })

  $('.searchBox').autoComplete({
    resolverSettings: {
      url: '/api/v1/fts'
    },
    events: {
      searchPost: function (res) {
        window.__searchResult = res;
        return res.map(function (p) {
          return {
            id: p.id,
            text: p.name
          }
        })
        // return window.__searchResult;
      }

    }
  });

  $('.searchBox').on('autocomplete.select', function (evt, item) {
    let go = window.__searchResult.find(function (result) {
      return result.id == item.id
    });
    window.location.href = go.url;
  });
</script>
<% if (typeof _usrmsg != 'undefined') { %>
<script>
  window.App.alert("<%=_usrmsg.text%>", "<%=_usrmsg.type %>")
</script>
<% } %>


<script>

  function setCookie(name, value, days) {
    var expires = "";
    if (days) {
      var date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "") + expires + "; path=/";
  }

  function getCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
      var c = ca[i];
      while (c.charAt(0) == ' ') c = c.substring(1, c.length);
      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
  }
  function eraseCookie(name) {
    document.cookie = name + '=; Max-Age=-99999999;';
  }

  $(document).ready(function () {

    var ulg = window.kb.userlocation();
    var guideinited = false;
    var inited = false;



    var userGuide = {
      guideinited: false,
      autoPopuped: getCookie("guidewindow"),
      open: function () {
        if (!this.guideinited) {
          this.guideinited = true;
          ulg.init({
            openDistricts: false,
            cityDomSelector: "#guidecityselectpicker",
            districtDomSelector: "#guidedistrictselectpicker"
          }, function () {
            $('#meatGuideModal').modal();
            $("#meat-guide-close-button").click(function () {
              f = $("#meat-guide-form")[0]
              if (f.checkValidity()) {
                $.ajax({
                  type: "POST",
                  url: "/api/v1/sitelog/create",
                  data: {
                    //district: ulg.selectedDistrict.name,
                    city: ulg.selectedCity.name,
                    email: $("#user-email").val(),
                    logtype: "anonymous-user-download-meat-guide"
                  },
                  success: function () {
                    $('#meatGuideModal').modal("hide");
                    alert("Teşekkürler")
                  }
                }
                )
              }
            });
            $('#meatGuideModal').on('shown.bs.modal', function () {

            })
          });
        } else $('#meatGuideModal').modal("show")

      }
    }


    $(".select-area-action").click(function () {
      window.kb.selectArea(function (sender, ul) {
        window.location.href = "/adres-belirle/" + ul.selectedDistrict.slug + '?r=' + window.location.href;
        //window.location.reload(true) // = "/" + window.App.ProductApp.product.slug + "?semt=" + ul.selectedDistrict.slug

      });
    })

    $(".explore-area-action").click(function () {
      window.kb.selectArea(function (sender, ul) {
        window.location.href = "/" + ul.selectedDistrict.slug + "-kasap?save=1"

      });
    })

    $(".get-userguide-action").click(function () {
      userGuide.open();
    })


    $(window).scroll(function () {
      if (($(document).scrollTop() >= $(document).height() / 3) && !userGuide.autoPopuped) {
        userGuide.autoPopuped = true;
        setCookie("guidewindow", "1", 30);
        userGuide.open();
      }
    });

  })

</script>



<script>
  $(document).ready(function () {
    var allImages = document.querySelectorAll(".gallery-item");
    allImages.forEach((value) => {
      value.oncontextmenu = (e) => {
        e.preventDefault()
        return false;
      }
    })
  });


</script>

<script>
$('#__whatsup').floatingWhatsApp({
    phone: '908503054216',
    popupMessage: 'Nasıl yardımcı olabilirim ?',
    showPopup: false,
    showOnIE: false,
    headerTitle: 'Hoşgeldiniz!',
    position: 'right',
    zIndex: '1030',
    message: '<%= typeof(__supportMessage) == "undefined" ? '': __supportMessage %>',
    size: '3.2rem',
    //buttonImage: '<img src="/static/img/logo-home.png" />'
    
  });

</script>
<% if (!__req.user) { %>

<script>
  window.App.User = {
    isAuthenticated: false
  }
</script>



<% } else { %>

<script>
  window.App.User = {
    isAuthenticated: <%=__req.user ? true : false %>,

    prefAdr: <%- JSON.stringify(__req.prefAddr || {}) %>
  }
</script>



<%}%>
{"version":3,"sources":["../src/db/models/order.ts"],"names":[],"mappings":"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","file":"order.js","sourcesContent":["import { Table, Column, DataType, Model, HasMany, CreatedAt, UpdatedAt, DeletedAt, Unique, Default, AllowNull, ForeignKey, BelongsTo } from 'sequelize-typescript';\nimport BaseModel from \"./basemodel\"\nimport Helper from '../../lib/helper';\nimport { ShopCard, ShopcardItem, firstOrderDiscount } from '../../models/shopcard';\nimport Product from './product';\nimport Butcher from './butcher';\nimport { OrderItemStatus, OrderSource, OrderType } from '../../models/order';\nimport Dispatcher, { DispatcherType } from './dispatcher';\nimport { GeoLocation, LocationSource, LocationType } from '../../models/geo';\nimport AccountModel from './accountmodel';\nimport { PuanResult } from '../../models/puan';\nimport { ProductTypeManager, ProductTypeFactory } from '../../lib/common';\nimport { ComissionHelper } from '../../lib/commissionHelper';\nimport { method } from 'lodash';\nimport { ShipmentType, HowToShipType } from '../../models/shipment';\nconst orderid = require('order-id')('dkfjsdklfjsdlkg450435034.,')\n\n@Table({\n    tableName: \"Orders\",\n    indexes: [{\n        fields: ['userId'],\n        name: 'userid_idx'\n    }, {\n        fields: ['ordernum'],\n        name: 'ordernum_idx',\n        unique: true\n    }]\n})\nclass Order extends BaseModel<Order> {\n\n    isFirstButcherOrder: boolean = false;\n    isFirstOrder: boolean = false;\n    workedAccounts: AccountModel[] = [];\n    butcherPuanAccounts: AccountModel[] = [];\n    kalittePuanAccounts: AccountModel[] = [];\n\n    kalitteOnlyPuanAccounts: AccountModel[] = [];\n    kalitteByButcherPuanAccounts: AccountModel[] = [];\n    \n    butcherDeptAccounts: AccountModel[] = [];\n    butcherComissiomAccounts: AccountModel[] = [];\n\n    puanSummary: PuanResult [] = [];\n\n    @Column({\n        allowNull: false,\n    })\n    userId: number;\n\n    @Column({\n        allowNull: false,\n        defaultValue: false\n    })\n    noInteraction: boolean;\n\n    @Column({\n        allowNull: false,\n    })\n    ordernum: string;\n\n    @Column({\n        allowNull: true        \n    })\n    paymentId: string;    \n\n    @Column({\n        allowNull: false,\n        defaultValue: OrderSource.kasaptanal\n    })\n    orderSource: string;    \n\n    @Column({\n        allowNull: false,\n        defaultValue: OrderType.generic\n    })\n    orderType: string;      \n\n    @Column({\n        allowNull: true        \n    })\n    paymentTransactionId: string;        \n\n    @Column({\n        allowNull: true\n    })  \n    subMerchantStatus: string;        \n\n    @Column({\n        allowNull: true\n    })\n    ordergroupnum: string;    \n\n    @Column({\n        allowNull: true,\n        type: DataType.TEXT\n    })\n    note: string;\n\n    @ForeignKey(() => Butcher)\n    butcherid: number;\n\n    @BelongsTo(() => Butcher, \"butcherid\")\n    butcher: Butcher;  \n    \n    @Column({\n        allowNull: false,\n        defaultValue: 'belli deÄŸil'        \n    })\n    butcherName: string;\n\n\n    @Column({\n        allowNull: false,\n    })\n    name: string;\n\n    @Column({\n        allowNull: false,\n    })\n    email: string;\n\n    @Column({\n        allowNull: false,\n    })\n    phone: string;\n\n    @Column({\n        allowNull: true\n    })\n    areaLevel1Id: number;\n\n    @Column({\n        allowNull: true\n    })\n    areaLevel2Id: number;\n\n    @Column({\n        allowNull: true\n    })\n    areaLevel3Id: number;\n\n    @Column({\n        allowNull: false,\n        defaultValue: true\n    })\n    saveAddress: boolean;\n\n    @Column({\n        allowNull: true\n    })\n    address: string;\n\n    get displayAddress() {\n        return `${this.address} Bina: ${this.bina}, Kat: ${this.kat}, Daire: ${this.daire}. + ${this.areaLevel3Text}, ${this.areaLevel2Text}/${this.areaLevel1Text}`\n    }\n\n    @Column({\n        allowNull: true\n    })\n    bina: string;\n\n    @Column({\n        allowNull: true\n    })\n    adresTarif: string;    \n\n    @Column({\n        allowNull: true\n    })\n    kat: string;\n\n    @Column({\n        allowNull: true\n    })\n    daire: string;\n\n    @Column({\n        allowNull: true\n    })\n    areaLevel1Text: string;\n\n    @Column({\n        allowNull: true\n    })\n    areaLevel2Text: string;\n\n    @Column({\n        allowNull: true\n    })\n    areaLevel3Text: string;\n\n\n    @Column({\n        allowNull: true\n    })\n    locationType: LocationType;   \n\n    @Column({\n        allowNull: true,\n        type: DataType.GEOMETRY('POINT')\n    })\n    shipLocation: GeoLocation;\n\n    @Column\n    shipLocationAccuracy: number\n\n    // @Column({\n    //     allowNull: true,\n    //     type: DataType.GEOMETRY('POINT')\n    // })\n    // dispatcherLocation: GeoLocation;    \n\n    @Column({\n        allowNull: true\n    })\n    dispatcherDistance: number;    \n\n    @HasMany(() => OrderItem, {\n        sourceKey: \"id\",\n        foreignKey: \"orderid\",\n        //as: \"ButcherProduct\"\n    })\n    items: OrderItem[];      \n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    subTotal: number;\n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    discountTotal: number;\n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    shippingTotal: number;\n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    total: number;\n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2),\n        defaultValue: 0.00\n    })\n    paidTotal: number;    \n\n    @Column({\n        allowNull: true    \n    })    \n    status: string;    \n\n    @Column({\n        allowNull: true    ,\n        type: DataType.TEXT\n    })    \n    statusDesc: string;      \n\n    @Column\n    shopcardjson: Buffer\n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(5, 2)\n    })    \n    userRating: number;    \n\n    @ForeignKey(() => Dispatcher)\n    dispatcherid: number;\n\n    @Column({\n        allowNull: true\n    })\n    dispatcherType: DispatcherType;  \n\n    @Column({\n        allowNull: true\n    })\n    dispatcherName: string;      \n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(13, 2)\n    })\n    dispatcherFee: number;     \n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(13, 2)\n    })\n    dispatcherFeeOffer: number;      \n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(13, 2)\n    })\n    dispatchertotalForFree: number;   \n    \n    @Column({\n        allowNull: true\n    })\n    shipmentType: ShipmentType;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentTypeText: string;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentHowTo: HowToShipType;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentHowToText: string;\n\n    @Column({\n        allowNull: true\n    })\n    securityCode: string;   \n\n    @Column({\n        allowNull: true\n    })\n    shipmentdate: Date;\n\n    @Column({\n        allowNull: true\n    })\n    shipmenthour: number;\n\n    @Column({\n        allowNull: true\n    })\n    shipmenthourText: string;\n\n    @Column({\n        allowNull: true\n    })\n    paymentType: string;\n\n    @Column({\n        allowNull: true\n    })\n    paymentStatus: string;    \n\n    @Column({\n        allowNull: true\n    })\n    paymentTypeText: string;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentInformMe: boolean;    \n\n\n\n    get shopcard(): Object {\n        return JSON.parse((<Buffer>this.getDataValue('shopcardjson')).toString())\n    }\n\n    set shopcard(value: Object) {\n        this.setDataValue('shopcardjson', Buffer.from(JSON.stringify(value), \"utf-8\"));\n    }\n\n\n    getButcherRate() {\n        if (this.orderSource == OrderSource.kasaptanal) {\n            if (this.orderType == OrderType.kurban) {\n                return this.butcher.kurbanCommissionRate;    \n            } else {\n                if (this.dispatcherType == \"butcher\") {\n                    return this.butcher.commissionRate                               \n                } else {\n                    return this.butcher.noshipCommissionRate;\n                }                \n            } \n        } else return this.butcher.payCommissionRate;   \n    }\n\n    getButcherFee() {\n        if (this.orderSource == OrderSource.kasaptanal) {\n            if (this.orderType == OrderType.kurban) {\n                return this.butcher.kurbanCommissionFee;    \n            } else {\n                if (this.dispatcherType == \"butcher\") {\n                    return this.butcher.commissionFee                               \n                } else {\n                    return this.butcher.noshipCommissionFee;\n                }\n            } \n                 \n        } else return this.butcher.payCommissionFee;   \n\n        \n    }\n\n    getPuanTotal(shouldBePaid: number) {\n        let result = 0.00;\n        if (this.orderSource == OrderSource.kasaptanal) {\n            let butcherPuanEarned = this.butcherPuanAccounts.find(p => p.code == 'total');\n            let kalitteOnlyPuanEarned = this.kalitteOnlyPuanAccounts.find(p => p.code == 'total');\n            let kalitteByButcherEarned = this.kalitteByButcherPuanAccounts.find(p => p.code == 'total');\n            let butcherPuan = Helper.asCurrency(butcherPuanEarned.alacak - butcherPuanEarned.borc);\n            let kalitteByButcherPuan = Helper.asCurrency(kalitteByButcherEarned.alacak - kalitteByButcherEarned.borc);\n            let totalPuanByButcher = Helper.asCurrency(butcherPuan + kalitteByButcherPuan);\n            let totalPuanByButcherIncVat = Helper.asCurrency(totalPuanByButcher * 1.18);\n            result = Helper.asCurrency(totalPuanByButcherIncVat);\n        }  \n\n        return result;\n    }\n\n  \n\n    getButcherComission(shouldBePaid: number) {\n        let rate = this.getButcherRate(); \n        let fee = this.getButcherFee();\n        let calc = new ComissionHelper(rate, fee);\n        let totalFee = calc.calculateButcherComission(shouldBePaid);\n        let merchantPrice = Helper.asCurrency(totalFee.kalitteFee + totalFee.kalitteVat);\n        return merchantPrice;     \n    }\n\n    static async fromShopcard(c: ShopCard, bi: number): Promise<Order> {\n        let o = new Order();\n        o.ordernum = orderid.generate();\n        o.note = c.note;\n        o.status = OrderItemStatus.supplying;\n        let firstDiscount = c.getButcherDiscount(bi, firstOrderDiscount.code)\n        o.isFirstButcherOrder = firstDiscount != null;\n        o.discountTotal = c.getButcherDiscountTotal(bi);\n        o.subTotal = c.butchers[bi].subTotal;        \n        o.shippingTotal = c.getShippingCostOfCustomer(bi);\n        o.total = c.getButcherTotal(bi);        \n        o.areaLevel1Id = c.address.level1Id;\n        o.areaLevel3Id = c.address.level3Id;\n        o.areaLevel1Text = c.address.level1Text;\n        o.areaLevel3Text = c.address.level3Text;\n        o.email = c.address.email;\n        o.address = c.address.adres;\n        o.bina = c.address.bina;\n        o.kat = c.address.kat;\n        o.daire = c.address.daire;\n        o.adresTarif = c.address.addresstarif;\n        if (c.address.geolocation) {\n            o.shipLocation = c.address.geolocation;\n            o.locationType = c.address.geolocationType\n        } else if (c.address.location) {\n            o.shipLocation = c.address.location;\n            o.shipLocationAccuracy = c.address.accuracy;\n        }\n        \n        o.phone = c.address.phone;\n        o.name = c.address.name;\n        o.saveAddress = c.address.saveaddress;\n        o.noInteraction = c.shipment[bi].nointeraction;\n        o.orderType = c.getOrderType();\n        \n        if (c.shipment[bi].dispatcher) {\n            o.dispatcherid = c.shipment[bi].dispatcher.id;\n            o.dispatcherFee = c.shipment[bi].dispatcher.fee;\n            o.dispatcherFeeOffer = c.shipment[bi].dispatcher.feeOffer;\n            o.dispatcherName = c.shipment[bi].dispatcher.name;\n            o.dispatcherType = c.shipment[bi].dispatcher.type;\n            o.dispatchertotalForFree = c.shipment[bi].dispatcher.totalForFree;         \n            if (o.shipLocation && c.shipment[bi].dispatcher.location) {\n                o.dispatcherDistance = Helper.distance(o.shipLocation, c.shipment[bi].dispatcher.location)\n            }        \n        }\n\n        o.shipmentHowTo = c.shipment[bi].howTo;\n        o.shipmentHowToText = c.shipment[bi].howToDesc;\n        o.paymentType = c.payment[bi].type;\n        o.paymentTypeText = c.payment[bi].desc;\n        o.shipmentType = c.shipment[bi].type;\n        o.shipmentTypeText = c.shipment[bi].desc;\n        o.shipmentdate = c.shipment[bi].days[0] ? new Date(c.shipment[bi].days[0]): null;\n        o.shipmenthour = c.shipment[bi].hours[0];\n        o.shipmenthourText = c.shipment[bi].hoursText[0];\n        o.shipmentInformMe = c.shipment[bi].informMe;\n\n        return o;\n    }\n\n}\n\n@Table({\n    tableName: \"OrderItems\",\n    indexes: [{\n        fields: ['orderId'],\n        name: 'orderid_idx'\n    }]\n})\nclass OrderItem extends BaseModel<Order> {\n\n    @ForeignKey(() => Order)\n    orderid: number;\n\n    @BelongsTo(() => Order, \"orderid\")\n    order: Order;\n\n    @ForeignKey(() => Product)\n    productid: number;\n\n    @BelongsTo(() => Product, \"productid\")\n    product: Product;\n\n    @Column({\n        allowNull: false,\n        defaultValue: 'generic'        \n    })\n    productType: string;    \n\n    @Column({\n        allowNull: true\n    })\n    custom1: string;   \n\n    @Column({\n        allowNull: true\n    })\n    custom2: string;   \n    \n    @Column({\n        allowNull: true\n    })\n    custom3: string;   \n    \n    \n    @Column({\n        allowNull: true\n    })\n    custom4: string;   \n\n    @Column({\n        allowNull: true\n    })\n    custom5: string;    \n\n    @Column({\n        allowNull: true\n    })\n    custom6: string;       \n\n    @Column({\n        allowNull: true\n    })\n    custom7: string;   \n\n    @Column({\n        allowNull: true\n    })\n    custom8: string;   \n\n    @Column({\n        allowNull: true\n    })\n    custom9: string;       \n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    quantity: number;\n\n    @ForeignKey(() => Butcher)\n    butcherid: number;\n\n    @BelongsTo(() => Butcher, \"butcherid\")\n    butcher: Butcher;    \n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(5, 2)\n    })    \n    userRating: number;\n\n    @Column({\n        allowNull: true    \n    })  \n    paymentTransactionId: string;\n\n    @Column({\n        allowNull: true\n    })  \n    subMerchantStatus: string;    \n\n    @Column({\n        allowNull: true    \n    })    \n    status: string;    \n\n    @Column({\n        allowNull: true    ,\n        type: DataType.TEXT\n    })    \n    statusDesc: string;    \n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    kgPrice: number;\n\n    @Column({\n        allowNull: true\n    })\n    viewUnit: string;\n\n    @Column({\n        allowNull: true\n    })\n    viewUnitDesc: string;\n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(13, 2)\n    })\n    viewUnitAmount: number;\n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(13, 2)\n    })\n    viewUnitPrice: number;\n\n\n    @Column({\n        allowNull: false\n    })\n    productName: string;\n\n\n    @Column({\n        allowNull: false,\n        defaultValue: 0.00,\n        type: DataType.DECIMAL(13, 2)\n    })\n    price: number;\n\n    @Column({\n        allowNull: false,\n        defaultValue: 0.00,\n        type: DataType.DECIMAL(13, 2)\n    })\n    paidPrice: number;    \n\n    @Column({\n        allowNull: false\n    })\n    pounit: string;\n\n    @Column({\n        allowNull: true\n    })\n    pounitTitle: string;    \n\n    @Column({\n        allowNull: true\n    })\n    pounitWeight: string;       \n\n    @Column({\n        allowNull: false,\n        type: DataType.TEXT\n    })\n    pounitdesc: string;\n\n    @Column({\n        allowNull: true    \n    })\n    orderitemnum: string;\n\n\n    @Column({\n        allowNull: false,\n        defaultValue: 0,\n        type: DataType.DECIMAL(13, 2)\n    })\n    pounitkgRatio: number;\n\n    @Column({\n        allowNull: false,\n        defaultValue: 0,\n        type: DataType.DECIMAL(13, 2)\n    })\n    pounitPrice: number;\n\n    @Column({\n        allowNull: false\n    })\n    shipmentType: string;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentTypeText: string;\n\n    @Column({\n        allowNull: false\n    })\n    shipmentHowTo: string;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentHowToText: string;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentdate: Date;\n\n    @Column({\n        allowNull: true\n    })\n    shipmenthour: number;\n\n    @Column({\n        allowNull: true\n    })\n    shipmenthourText: string;\n\n    @Column({\n        allowNull: false\n    })\n    paymentType: string;\n\n    @Column({\n        allowNull: true\n    })\n    paymentTypeText: string;\n\n    @Column({\n        allowNull: true\n    })\n    shipmentInformMe: boolean;    \n\n    @ForeignKey(() => Dispatcher)\n    dispatcherid: number;\n\n    @Column({\n        allowNull: true\n    })\n    dispatcherType: string;  \n\n    @Column({\n        allowNull: true\n    })\n    dispatcherName: string;      \n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(13, 2)\n    })\n    dispatcherFee: number;     \n\n \n\n    @Column({\n        allowNull: true,\n        type: DataType.DECIMAL(13, 2)\n    })\n    dispatchertotalForFree: number;       \n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    discountTotal: number;\n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    shippingTotal: number;\n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    butcherSubTotal: number;    \n\n    @Column({\n        allowNull: false,\n        type: DataType.DECIMAL(13, 2)\n    })\n    butcherTotal: number;\n\n\n    @Column({\n        allowNull: true\n    })\n    note: string;\n\n    get productTypeManager() {\n        let result = ProductTypeFactory.create(this.productType, {});\n        result.loadFromOrderItem(this);\n        return result;\n    }\n\n    static fromShopcardItem(sc: ShopCard, i: ShopcardItem) {\n        let c = new OrderItem();\n        c.productid = i.product.id;\n        c.price = i.price;\n        c.status = OrderItemStatus.supplying;\n        c.productName = i.product.name;\n        c.kgPrice = i.product.kgPrice;\n        c.orderitemnum = orderid.generate();\n        c.productType = i.product.productType;\n        let prodMan = ProductTypeFactory.create(c.productType, i.productTypeData);\n        prodMan.saveToOrderItem(c);\n        // c.viewUnit = i.product.viewUnit;\n        // c.viewUnitAmount = i.product.viewUnitAmount;\n        // c.viewUnitDesc = i.product.viewUnitDesc;\n        // c.viewUnitPrice = i.product.viewUnitPrice;\n        c.butcherid = i.product.butcher.id;\n        c.shipmentHowTo = sc.shipment[c.butcherid].howTo;\n        c.shipmentHowToText = sc.shipment[c.butcherid].howToDesc;\n        c.paymentType = sc.payment[c.butcherid].type;\n        c.paymentTypeText = sc.payment[c.butcherid].desc;\n        c.shipmentType = sc.shipment[c.butcherid].type;\n        c.shipmentTypeText = sc.shipment[c.butcherid].desc;\n        c.shipmentdate = sc.shipment[c.butcherid].days[0] ? new Date(sc.shipment[c.butcherid].days[0]): null;\n        c.shipmenthour = sc.shipment[c.butcherid].hours[0];\n        c.shipmenthourText = sc.shipment[c.butcherid].hoursText[0];\n        c.shipmentInformMe = sc.shipment[c.butcherid].informMe;\n\n        if (sc.shipment[c.butcherid].dispatcher) {\n            c.dispatcherid = sc.shipment[c.butcherid].dispatcher.id;\n            c.dispatcherFee = sc.shipment[c.butcherid].dispatcher.fee;\n            c.dispatcherName = sc.shipment[c.butcherid].dispatcher.name;\n            c.dispatcherType = sc.shipment[c.butcherid].dispatcher.type;\n            c.dispatchertotalForFree = sc.shipment[c.butcherid].dispatcher.totalForFree;            \n        }\n\n        c.quantity = i.quantity;\n        c.pounit = i.purchaseoption.unit;\n        c.pounitTitle = i.purchaseoption.unitTitle;\n        c.pounitWeight = i.purchaseoption.unitWeight;\n        c.pounitdesc = i.purchaseoption.desc;\n        c.pounitPrice = i.purchaseoption.unitPrice;\n        c.pounitkgRatio = i.purchaseoption.kgRatio;\n        \n        c.discountTotal = sc.getButcherDiscountTotal(c.butcherid);\n        c.shippingTotal = sc.getShippingCostOfCustomer(c.butcherid);\n        c.butcherTotal = sc.getButcherTotal(c.butcherid);\n        c.butcherSubTotal = sc.butchers[c.butcherid].subTotal;\n        c.note = i.note;\n\n        return c;\n    }\n\n}\n\nexport { Order, OrderItem };"],"sourceRoot":"../../../src/"}
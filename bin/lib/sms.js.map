{"version":3,"sources":["../src/lib/sms.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,MAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAA;AAE9B,iCAA6C;AAC7C,mCAA4B;AAG5B,MAAa,GAAG;IACZ,MAAM,CAAO,IAAI,CAAC,EAAU,EAAE,IAAY,EAAE,WAAoB,IAAI,EAAE,MAAoB;;YACtF,IAAI,GAAG,GAAG,mDAAmD,UAAU,4BAA4B,EAAE,YAAY,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC;YAChK,IAAI,IAAmB,CAAC;YACxB,IAAI;gBACA,IAAI,GAAG,MAAM,eAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBAC5B,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC;oBAC1D,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;gBACvC,IAAI,MAAM,EAAE;oBACR,MAAM,MAAM,CAAC,GAAG,CAAC;wBACb,OAAO,EAAE,IAAI;wBACb,OAAO,EAAE,KAAK;wBACd,KAAK,EAAE,EAAE;qBACZ,CAAC,CAAA;iBACL;aACJ;YAAC,OAAM,GAAG,EAAE;gBACT,eAAK,CAAC,IAAI,CAAC,kBAAkB,EAAE,0BAA0B,EAAE,WAAW,EAAE;oBACpE,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,CAAC,OAAO;oBACrD,KAAK,EAAE,GAAG,CAAC,KAAK;iBACnB,CAAC,CAAA;gBACF,IAAI,QAAQ;oBACP,MAAM,GAAG,CAAC;aAClB;QACL,CAAC;KAAA;CACJ;AAxBD,kBAwBC","file":"sms.js","sourcesContent":["const Nexmo = require(\"nexmo\")\nimport config from \"../config\";\nimport axios, { AxiosResponse } from \"axios\";\nimport email from './email';\nimport SiteLogRoute from \"../routes/api/sitelog\";\n\nexport class Sms {\n    static async send(to: string, text: string, throwexc: boolean = true, logger: SiteLogRoute) {\n        let url = `https://api.netgsm.com.tr/sms/send/get?usercode=${8503054216}&password=BOV0MN1M&gsmno=${to}&message=${encodeURI(text)}&msgheader=${('KALITTE LTD')}`;\n        let resp: AxiosResponse;\n        try {\n            resp = await axios.get(url);\n            if ([\"20\", \"30\", \"40\", \"70\"].indexOf(resp.data.toString()) > 0)\n                throw new Error(\"SMS iletilemedi\");\n            if (logger) {\n                await logger.log({                    \n                    logData: text,\n                    logtype: \"SMS\",\n                    email: to              \n                })\n            }            \n        } catch(err) {\n            email.send('tansut@gmail.com', 'hata/SMS: kasaptanAl.com', \"error.ejs\", {\n                text: err + \"/\" + to + \"/\" + text + \"/\" + err.message,\n                stack: err.stack\n            })                  \n            if (throwexc)\n                 throw err;\n        }\n    }\n}"],"sourceRoot":"../../src/"}
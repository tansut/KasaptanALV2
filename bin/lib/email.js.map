{"version":3,"sources":["../src/lib/email.ts"],"names":[],"mappings":";;AACA,sCAA+B;AAC/B,yCAAyC;AACzC,2DAA2D;AAC3D,2BAA2B;AAE3B,6BAA6B;AAG7B,MAAM,YAAY;IAGd,MAAM,CAAC,aAAa;QAChB,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC,eAAe,CAAC,aAAa,CAAC;YACxD,IAAI,EAAE,gBAAM,CAAC,SAAS;YACtB,IAAI,EAAE,gBAAM,CAAC,SAAS;YACtB,MAAM,EAAE,KAAK;YACb,IAAI,EAAE;gBACF,IAAI,EAAE,gBAAM,CAAC,aAAa;gBAC1B,IAAI,EAAE,gBAAM,CAAC,SAAS;aACzB;SACJ,CAAC,CAAC,CAAC;IAER,CAAC;IAID,IAAI,CAAC,EAAU,EAAE,OAAe,EAAE,QAAgB,EAAE,IAA6B;QAC7E,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACnC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAM,CAAC,UAAU,EAAE,kBAAkB,GAAG,QAAQ,CAAC,EAAE,IAAI,EAAE,EAEjF,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;gBACZ,IAAI,GAAG;oBAAE,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC;gBAC5B,IAAI,WAAW,GAAG;oBACd,EAAE,EAAE,EAAE;oBACN,EAAE,EAAE,wBAAwB;oBAC5B,IAAI,EAAE,yCAAyC;oBAC/C,OAAO,EAAE,OAAO;oBAChB,IAAI,EAAE,GAAG;iBACZ,CAAA;gBACD,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE;oBAC3D,iDAAiD;gBACrD,CAAC,CAAC,CAAC;gBAEH,OAAO,EAAE,CAAA;YAEb,CAAC,CAAC,CAAC;QAEP,CAAC,CAAC,CAAA;IACN,CAAC;CAEJ;AAED,YAAY,CAAC,aAAa,EAAE,CAAC;AAE7B,kBAAe,CAAC,IAAI,YAAY,EAAE,CAAC,CAAC","file":"email.js","sourcesContent":["import * as common from './common';\nimport config from '../config';\nimport * as nodemailer from 'nodemailer';\nimport * as smtpTransport from 'nodemailer-smtp-transport';\nimport * as ejs from 'ejs';\nimport * as http from './http'\nimport * as path from 'path';\n\n\nclass EmailManager {\n    static transporter: nodemailer.Transporter;\n\n    static initTransport() {\n        this.transporter = nodemailer.createTransport(smtpTransport({\n            host: config.emailHost,\n            port: config.emailPort,\n            secure: false,\n            auth: {\n                user: config.emailUsername,\n                pass: config.emailPass\n            }\n        }));\n\n    }\n\n\n\n    send(to: string, subject: string, template: string, data?: { [key: string]: any }): Promise<any> {\n        return new Promise((resolve, reject) => {\n            ejs.renderFile(path.join(config.projectDir, 'src/views/email/' + template), data, {\n\n            }, (err, res) => {\n                if (err) return reject(err);\n                var mailOptions = {\n                    to: to,\n                    cc: 'archive@kasaptanal.com',\n                    from: 'kasaptanAl.com <noreply@kasaptanal.com>',\n                    subject: subject,\n                    html: res\n                }\n                EmailManager.transporter.sendMail(mailOptions, (error, info) => {\n                    // error ? reject(error) : resolve(info.response)\n                });\n\n                resolve()\n\n            });\n\n        })\n    }\n\n}\n\nEmailManager.initTransport();\n\nexport default (new EmailManager());"],"sourceRoot":"../../src/"}